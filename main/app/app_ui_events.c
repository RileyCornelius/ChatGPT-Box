// This file was generated by SquareLine Studio
// SquareLine Studio version: SquareLine Studio 1.2.3
// LVGL version: 8.3.4
// Project name: chat_gpt_new_gui

#include "app_sr.h"

#include "ui.h"
#include "app_ui_ctrl.h"
#include "OpenAI.h"
#include "esp_ota_ops.h"
#include "esp_system.h"
#include "esp_log.h"
#include "hal/usb_phy_ll.h"
#include "settings.h"
#include "openai_api.h"

static char *TAG = "ui-events";

void EventBtnSetupClick(lv_event_t *e)
{
    ui_sleep_show_animation();
}

void EventPanelSleepClickCb(lv_event_t *e)
{
    app_sr_start_once();
    ESP_LOGI(TAG, "sr start once");
}

void EventWifiResetConfirmClick(lv_event_t *e)
{
    static bool started = false;
    if (!started)
    {
        started = true;
        ESP_LOGI(TAG, "Start USB UF2 NVS");
        lv_label_set_text(ui_LabelSetupBtn1, "Reboot");
        uf2_nvs_storage_init(); // Configure USB NVS
    }
    else
    {
        ESP_LOGI(TAG, "Reboot from WIFI Page to Factory Partition");
        usb_phy_ll_int_jtag_enable(&USB_SERIAL_JTAG); // Configure USB PHY, Change back to USB-Serial-Jtag
        esp_restart();
    }
}

void EventSettingsServiceValueChange(lv_event_t *e)
{
    lv_obj_t *obj = lv_event_get_target(e);
    uint8_t index = lv_dropdown_get_selected(obj);
    if (index == SERVICE_TYPE_CHAT)
    {
        openai_service_type = SERVICE_TYPE_CHAT;
        ESP_LOGI(TAG, "Service Type: Chat");
    }
    else if (index == SERVICE_TYPE_IMAGE)
    {
        openai_service_type = SERVICE_TYPE_IMAGE;
        ESP_LOGI(TAG, "Service Type: Image");
    }
}

void EventDalleImageClick(lv_event_t *e)
{
    ui_ctrl_go_to_listening_screen();
}